# 傀儡进程附加读写

看雪上的傀儡进程附加其实可以进一步简化

本质上ATTCH检测的就是EPROCESS (或者CR3(不确定));

- **一种方法是创建一个进程**

把这个进程的CR3的PML4E全修改成进程的(或者替换CR3,可能会被检测)

如果真到了扫PML4E的地步,这个会被检测,因为他是一个正规的进程,可以被链表挂上。

- **还有一种方法是创建一个非分页内存**

把某个进程的EPROCESS一字不拉的复制上去。

只修改0x28的CR3,这样直接用MmCpoyVA读写

如果是查线程的话,此时查ATTCH Process,应该不会查到,

当然,为了保险,可以在申请一个4KB页面,把CR3的PML4E复制过去

当然这样的缺点是有可能会PML4E被换新的。不是原来的,但是这样可以规避一层检查。